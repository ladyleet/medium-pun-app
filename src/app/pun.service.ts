import { Injectable } from '@angular/core';
//need to import rxjs

export interface Pun {
  pun: string,
  answer: string
};

const keywords = {
  'banana': [0, 13, 14, 15, 16],
  'cheese': [3, 4, 5, 6, 7, 8, 12, 17, 23],
  'bird': [3, 11, 12, 1, 20],
  'hotel': [4, 9, 10, 11],
  'mexican': [6, 17, 21, 22, 23, 24, 25], 
  'cow': [12, 26, 27, 28, 29, 30, 31],
  'egg': [18, 19, 20, 32, 33]
};


const puns = {
  '0': {
    pun: 'My wife has banana diet',
    answer: 'She hasnt lost weight, but you should see her climb trees now!'
  },
  '1': { 
    pun: 'Id make a pun about a chicken...', 
    answer: 'But it would be fowl.'
  },
  '2': {
    pun: 'this is a pun about a pickle and a hat', 
    answer: 'answer'
  },
  '3': {
    pun: 'What kind of cheese can fly?', 
    answer: 'Curds of Prey.'
  },
  '4': {
    pun: 'What hotel did the cheese stay at?', 
    answer: 'The Stilton.'
  },
  '5': {
    pun: 'What is the saddest cheese?', answer: 'Blue Cheese.'
  },
  '6': {
    pun: 'What do you call a cheese that isnt yours?', 
    answer: 'Nacho Cheese.'
  },
  '7': { 
    pun: 'What music does cheese listen to?', answer: 'R & Brie.'
  },
  '8': {
    pun: 'Whats always the last piece of cheese left?', 
    answer: 'Forever Provolone.'
  },
  '9': { 
    pun: 'I used to be a hotel clerk', 
    answer: 'But then I had reservations.'
  },
  '10': {
    pun: 'Im staying at a really trend new hotel', 
    answer: 'Its the inn thing to do.'
  },
  '11': {
    pun: 'A bird doctor checked into a hotel.', 
    answer: 'He said, "This is the best place I feather stayed at".'
  },
  '12': {
    pun: 'A bird and a cow go shopping for cheese. The cow, knowing he can produce the milk says to the bird, "this place is robin you blind!".', 
    answer: 'The bird says, "I like my cheese cheep cheep!'
  },
  '13': {
    pun: 'Why dont bananas snore?', 
    answer: 'They dont want to wake up the rest of the bunch!'
  },
  '14': { 
    pun: 'Why do bananas wear sunscreen?', 
    answer: 'Because they peel.'
  },
  '15': { 
    pun: 'What do you call two banana skins?', 
    answer: 'A pair of slippers.'
  },
  '16': {
    pun: 'Why are bananas never lonely?', 
    answer: 'Because they hang around in bunches.'
  },
  '17': {
    pun: 'A chef asked a tomato about to be diced into salsa how it was feeling.', 
    answer: 'He had a chip on his shoulders and said "its nacho business".'
  },
  '18': {
    pun: 'We saw Kanye the other day at breakfast.', 
    answer: 'Someone said "Om-a-lette you finish, but I hope that omelette is good!"'
  },
  '19': {
    pun: 'Was on a diet with my sister. She fed me one egg for lunch.', 
    answer: 'That had me bEGGing for more food!'
  },
  '20': {
    pun: 'How to roosters flirt with chickens?', 
    answer: 'They wish chickens an egg-stra special day.'
  },
  '21': {
    pun: 'How to tacos handle disputes?', 
    answer: 'They taco-ver coffee.'
  },
  '22': {
    pun: 'If youre hungry for mexican food, what is the worst thing you could do?', 
    answer: 'Burrito around the bush about it.'
  },
  '23': {
    pun: 'Our local Mexican restaurant was closed the other day.', 
    answer: 'They said it was a queso the flu.'
  },
  '24': {
    pun: 'Bunch of avocados decided to run a marathon.', 
    answer: 'They figure theyve guac what it takes.'
  },
  '25': {
    pun: 'Anyone been exposed to a cheesy mexican pun?', 
    answer: 'Que, so avocado say, weve all bean there, but lets not taco about it.'
  },
  '26': {
    pun: 'The cow told everyone his grandfather was a knight', 
    answer: 'And that his name was sir loin. I laughed so hard I had to rib my eyes.'
  },
  '27': {
    pun: 'Why was the cow afraid?', 
    answer: 'He was a cow-herd.'
  },
  '28': {
    pun: 'What do you call a cow with a twitch?', 
    answer: 'Beef jerky.'
  },
  '29': {
    pun: 'How do you count cows?', 
    answer: 'With a cow-culator.'
  },
  '30': {
    pun: 'What do you call a cow with 3 legs?', 
    answer: 'Lean beef.'
  },
  '31': {
    pun: 'Why did the cow get arrested?', 
    answer: 'He was using cow-nterfeit money.'
  },
  '32': {
    pun: 'This egg was egg-cellent at cracking me up.', 
    answer: 'He was making a lot of pun yolks.'
  },
  '33': {
    pun: 'The egg was egg-stremely happy.', 
    answer: 'But you couldnt really tell from his egg-spression.'
  }
};

@Injectable()
export class PunService {

  constructor() { }

  getPuns(kwds: string[]): Observable<Pun[]> {
    if (!kwds || kwds.length === 0) {
      return Observable.of([]);
    }
    const found = kwds.reduce((found, kwd) => {
      const ids = keywords[kwd];
      if (ids) {
        return ids.reduce((found, id) => {
          found[id] = puns[id];
          return found;
        }, found);
      }
      return found;
    }, {});

    return Observable.of(Object.keys(found).map(key => found[key]));
  }

  suggestKeywords(partial: string): Observable<string[]> {
    if (!partial) {
      return Observable.of([]);
    }

    return Observable.of(
      Object.keys(keywords)
        .filter(keyword => keyword.indexOf(partial) === 0)
    );

  }
}